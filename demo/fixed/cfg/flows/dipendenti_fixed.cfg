# ═══════════════════════════════════════════════════════════════════════════════
# Data Quality Framework - Configurazione Flusso
# ═══════════════════════════════════════════════════════════════════════════════
#
# AUTORE: Alberto Robetti
# CREAZIONE: 25/10/2025
# ULTIMO AGGIORNAMENTO: 13/11/2025
# VERSIONE: 1.0.0
# FLUSSO: DIPENDENTI_FIXED
#
# ═══════════════════════════════════════════════════════════════════════════════
# DESCRIZIONE
# ═══════════════════════════════════════════════════════════════════════════════
# Configurazione flusso per validazione anagrafica dipendenti in formato FIXED.
# File a larghezza fissa (fixed-width) senza header, encoding UTF-8.
# Ogni campo ha posizione iniziale (start) e lunghezza (length) definite nel layout.
#
# Validazioni implementate:
# - Matricola: Posizione 1-8, formato DIPxxxxx (obbligatorio, univoco)
# - Nome: Posizione 9-58, lunghezza 2-50 caratteri, pattern alfabetico
# - Cognome: Posizione 59-108, lunghezza 2-50 caratteri, pattern alfabetico
# - Email: Posizione 109-208, formato email valido
# - Telefono: Posizione 209-228, formato italiano +39xxxxxxxxxx o 0xxxxxxxxx
# - Data assunzione: Posizione 229-238, formato YYYY-MM-DD, range valido
# - Stipendio: Posizione 239-248, numerico positivo, range 15000-150000
# - Reparto: Posizione 249-268, lista valori ammessi (IT, HR, SALES, OPERATIONS, ADMIN)
#
# ═══════════════════════════════════════════════════════════════════════════════
# STRUTTURA FILE
# ═══════════════════════════════════════════════════════════════════════════════
# 1. METADATI PROCESSO: Informazioni descrittive (opzionale)
# 2. FILE INPUT/OUTPUT: Pattern file, directory elaborazione
# 3. FORMATO E ENCODING: Tipo file FIXED, codifica caratteri
# 4. PARAMETRI CSV: Non applicabili per FIXED ma documentati
# 5. LOGGING: Livelli dettaglio, abilitazione trace
# 6. PATTERN MATCHING: Selezione file multipli, ordinamento
# 7. OUTPUT NAMING: Suffix e timestamp file output (opzionale)
# 8. SPOSTAMENTO FILE: Gestione post-elaborazione (opzionale)
#
# ═══════════════════════════════════════════════════════════════════════════════
# PARAMETRI OBBLIGATORI
# ═══════════════════════════════════════════════════════════════════════════════
#
# DQ_DIR_TO_SCAN
#   Directory contenente file da elaborare (scansione automatica).
#   Formato: Path assoluto terminante con \
#   Esempio: C:\DataQualityFramework\demo\fixed\input\pending\
#
# DQ_FILE_TO_WORK
#   Pattern nome file da processare (supporta wildcard * e ?).
#   * = Qualsiasi sequenza caratteri
#   ? = Singolo carattere qualsiasi
#   Esempio: dipendenti_fixed_*.dat elabora dipendenti_fixed_20251101.dat, dipendenti_fixed_20251102.dat
#
# DQ_FILE_TRACCIATO
#   Path file layout CSV contenente definizione campi e regole validazione.
#   Per FIXED richiede colonne aggiuntive: start (posizione inizio), length (lunghezza campo)
#   Colonne richieste: Indice, NomeAttributo, TipoDato, Obbligatorio, Lunghezza,
#                      Pattern, ValoriAmmessi, FunzioneCustom, start, length
#   Formato: Path assoluto file .csv
#   Esempio: C:\DataQualityFramework\demo\fixed\cfg\layouts\dipendenti_fixed_layout.csv
#
# OUTPUT_DIR_VALID
#   Directory destinazione file con record validi (suffisso .ok).
#   Contiene solo righe che hanno superato tutte le validazioni.
#   Formato file identico a input (fixed-width senza colonna errori).
#   Formato: Path assoluto terminante con \
#
# OUTPUT_DIR_ERROR
#   Directory destinazione file con record errati (suffisso .ko).
#   Contiene righe con almeno un errore validazione.
#   Formato: Riga fixed-width originale + ERROR_CODES_SEPARATOR + codici errore
#   Esempio: Mario    Rossi    DIP00001|E001|E002|E003
#   Formato: Path assoluto terminante con \
#
# OUTPUT_DIR_REPORTS
#   Directory destinazione file anagrafica codici errore (suffisso .codici).
#   Contiene lista univoca codici errore rilevati con contatori occorrenze.
#   Formato: Path assoluto terminante con \
#
# OUTPUT_DIR_STATS
#   Directory destinazione file report statistiche (suffisso .stats).
#   Contiene statistiche dettagliate: totali record, validi, errori, qualita dati.
#   Formato: Path assoluto terminante con \
#
# FILE_FORMAT (default: CSV)
#   Formato file input: CSV (delimitato) o FIXED (posizionale).
#   Per questo flusso DEVE essere: FIXED
#
# FILE_ENCODING
#   Encoding caratteri file input e output.
#   Valori comuni: utf-8, iso-8859-1, cp1252, latin1
#   Esempio: utf-8
#
# ═══════════════════════════════════════════════════════════════════════════════
# PARAMETRI OPZIONALI
# ═══════════════════════════════════════════════════════════════════════════════
#
# ERROR_CODES_SEPARATOR (default: |)
#   Separatore codici errore appeso in coda alle righe .ko.
#   Per FIXED: codici aggiunti dopo fine riga fixed-width.
#   Esempio: Mario    Rossi    DIP00001|E001|E002
#   Utilizzo: Se record ha 3 errori, viene aggiunto |E001|E002|E003
#
# LOG_LEVEL (default: INFO)
#   Livello dettaglio logging validazione.
#   Valori: TRACE | DEBUG | DEBUG2 | DEBUG3 | INFO | WARNING | ERROR
#   TRACE = Log ogni singola validazione campo
#   DEBUG3 = Dettaglio operazioni principali
#   INFO = Solo informazioni essenziali
#
# DQ_ENABLE_FIELD_LOGGING (default: true)
#   Abilita logging validazione campo per campo.
#   true = Log dettagliato ogni attributo (verbose)
#   false = Log solo a livello riga
#
# DQ_ENABLE_ROW_LOGGING (default: true)
#   Abilita logging elaborazione riga per riga.
#   true = Log ogni record (verbose)
#   false = Log solo statistiche finali
#
# SORT_KEYS (default: nessuno)
#   Criteri ordinamento file multipli trovati da pattern matching.
#   Formato: nome[start:length:tipo:order]
#   tipo: numero | stringa
#   order: asc | desc
#   Esempio: nome[17:8:numero:desc] ordina per timestamp YYYYMMDD decrescente
#
# PROCESS_WHICH (default: last)
#   Strategia selezione file da elaborare dopo ordinamento.
#   first = Elabora solo primo file (es: piu recente se sort desc)
#   last = Elabora solo ultimo file (es: piu vecchio se sort desc)
#   all = Elabora tutti file trovati in sequenza
#
# OUTPUT_ADD_SUFFIX_TIMESTAMP (default: no)
#   Aggiunge suffix e timestamp ai file OUTPUT generati.
#   Disponibile solo con pattern matching attivo.
#   yes = File output: {basename_input}.{suffix}.{timestamp}.{ext}
#   no = File output: basename input + suffisso standard
#   Esempio: test.ok.20251106143022.dat
#
# OUTPUT_TIMESTAMP_FORMAT (default: YYYYMMDDHHmmSS)
#   Formato timestamp per file output se OUTPUT_ADD_SUFFIX_TIMESTAMP=yes.
#   YYYYMMDDHHmmSS = 20251106143022
#   YYYYMMDD_HHmmSS = 20251106_143022
#   YYYYMMDD = 20251106
#   YYYYMMDDHHmmSSfff = 20251106143022123 (con millisecondi)
#
# OUTPUT_SUFFIX_VALID (default: validi)
#   Suffix per file record validi quando OUTPUT_ADD_SUFFIX_TIMESTAMP=yes.
#
# OUTPUT_SUFFIX_ERROR (default: errori)
#   Suffix per file record errati quando OUTPUT_ADD_SUFFIX_TIMESTAMP=yes.
#
# OUTPUT_SUFFIX_CODES (default: codici)
#   Suffix per file lista codici errore quando OUTPUT_ADD_SUFFIX_TIMESTAMP=yes.
#
# OUTPUT_SUFFIX_STATS (default: stats)
#   Suffix per file statistiche quando OUTPUT_ADD_SUFFIX_TIMESTAMP=yes.
#
# ADD_SUFFIX_TIMESTAMP (default: yes)
#   Aggiunge suffix e timestamp ai file INPUT spostati dopo elaborazione.
#   Disponibile solo con pattern matching + MOVE_WORKED o MOVE_SKIPPED attivi.
#   yes = File spostati: {basename}.{suffix}.{timestamp}
#   no = File spostati: {basename}.{suffix}
#
# TIMESTAMP_FORMAT (default: YYYYMMDDHHmmSS)
#   Formato timestamp per file input spostati (vedi OUTPUT_TIMESTAMP_FORMAT).
#
# MOVE_SKIPPED (default: no)
#   Sposta file NON elaborati (skipped da PROCESS_WHICH) in directory separata.
#   yes = Sposta in SKIPPED_DIR con suffix SUFFIX_SKIPPED
#   no = Lascia file in INPUT_DIR
#
# SKIPPED_DIR (default: vuoto, richiesto se MOVE_SKIPPED=yes)
#   Directory destinazione file non elaborati.
#   Formato: Path assoluto terminante con \
#
# MOVE_WORKED (default: no)
#   Sposta file ELABORATI in directory separata (archivio).
#   yes = Sposta in WORKED_DIR con suffix ok/ko/worked secondo esito
#   no = Lascia file in INPUT_DIR
#
# WORKED_DIR (default: vuoto, richiesto se MOVE_WORKED=yes)
#   Directory destinazione file elaborati (archivio).
#   Formato: Path assoluto terminante con \
#
# SUFFIX_VALID (default: ok)
#   Suffix per file elaborati con successo totale (100% record validi).
#
# SUFFIX_ERROR (default: ko)
#   Suffix per file elaborati con errori totali (0% record validi).
#
# SUFFIX_WORKED (default: worked)
#   Suffix per file elaborati parzialmente (alcuni validi, alcuni errori).
#
# SUFFIX_SKIPPED (default: skipped)
#   Suffix per file non elaborati (ignorati da PROCESS_WHICH).
#
# PROCESSO_NOME (default: nome flusso)
#   Nome descrittivo processo per log e report.
#
# PROCESSO_VERSIONE (default: 1.0.0)
#   Versione processo per tracciamento evolutivo.
#
# PROCESSO_DESCRIZIONE (default: vuoto)
#   Descrizione estesa finalita e logica processo.
#
# ═══════════════════════════════════════════════════════════════════════════════

[FLUSSO]

# ═══════════════════════════════════════════════════════════════════════════════
# SEZIONE 1: METADATI PROCESSO (opzionale - informazioni descrittive)
# ═══════════════════════════════════════════════════════════════════════════════

# Nome del processo/flusso (usato nei log e report)
# PROCESSO_NOME=DIPENDENTI_FIXED

# Versione del processo (tracciamento versioni logiche business)
# PROCESSO_VERSIONE=1.0.0

# Descrizione dettagliata del processo
# PROCESSO_DESCRIZIONE=Validazione anagrafica dipendenti formato FIXED con funzioni custom

# ═══════════════════════════════════════════════════════════════════════════════
# SEZIONE 2: FILE INPUT/OUTPUT (obbligatori)
# ═══════════════════════════════════════════════════════════════════════════════

# --- INPUT PATTERN MATCHING ---
# Directory contenente i file da scansionare
DQ_DIR_TO_SCAN=C:\DataQualityFramework\demo\fixed\input\pending

# Pattern dei file da elaborare (supporta wildcard * ?)
DQ_FILE_TO_WORK=dipendenti_fixed_*.dat

# Path del file tracciato/layout (CSV con definizione campi)
# Colonne richieste: Indice, NomeAttributo, TipoDato, Obbligatorio
# Colonne FIXED: start, length
DQ_FILE_TRACCIATO=C:\DataQualityFramework\demo\fixed\cfg\layouts\dipendenti_fixed_layout.csv

# --- OUTPUT DIRECTORIES (v2.2) ---
# Directory output validi
OUTPUT_DIR_VALID=C:\DataQualityFramework\demo\fixed\output\success

# Directory output errori
OUTPUT_DIR_ERROR=C:\DataQualityFramework\demo\fixed\output\error

# Directory file anagrafica codici errori
OUTPUT_DIR_REPORTS=C:\DataQualityFramework\demo\fixed\output\report

# Directory file report statistiche dettagliate
OUTPUT_DIR_STATS=C:\DataQualityFramework\demo\fixed\output\statistics

# ═══════════════════════════════════════════════════════════════════════════════
# SEZIONE 3: FORMATO FILE E ENCODING
# ═══════════════════════════════════════════════════════════════════════════════

# Formato del file input: CSV | FIXED
# CSV = Campi delimitati da separatore (es: virgola)
# FIXED = Campi a posizione fissa (start/length)
FILE_FORMAT=FIXED

# Encoding del file (input e output)
# Valori comuni: utf-8, iso-8859-1, cp1252, latin1
FILE_ENCODING=utf-8

# Separatore tra codici errore nei file di scarto (.ko)
# Per FIXED: i codici vengono aggiunti in coda alla riga fixed separati da questo carattere
# Esempio: Mario    Rossi    DIP00001E001|E002|E003
# Default: | (pipe)
ERROR_CODES_SEPARATOR=|

# ═══════════════════════════════════════════════════════════════════════════════
# SEZIONE 4: PARAMETRI CSV (solo se FILE_FORMAT=CSV)
# ═══════════════════════════════════════════════════════════════════════════════

# Separatore campi CSV (default: virgola)
# Esempi: , (virgola), ; (punto e virgola), | (pipe), \t (tab)
# CSV_SEPARATOR=,

# Delimitatore di testo per campi quoted (default: doppia virgoletta)
# Usato per gestire separatori all'interno dei valori
# Esempi: " (doppia virgoletta), ' (singola virgoletta)
# CSV_DELIMITER="

# Numero di righe header da saltare (default: 1)
# 0 = Nessun header, 1 = Prima riga è header, 2+ = Skippa header multipli
# CSV_SKIP_HEADER_ROWS=1

# ═══════════════════════════════════════════════════════════════════════════════
# SEZIONE 5: LOGGING E DEBUG
# ═══════════════════════════════════════════════════════════════════════════════

# Livello di log del framework
# Valori: TRACE | DEBUG | DEBUG2 | DEBUG3 | INFO | WARNING | ERROR
# TRACE = Dettaglio massimo (ogni campo validato)
# DEBUG/DEBUG2/DEBUG3 = Dettaglio crescente operazioni
# INFO = Solo informazioni principali (default produzione)
# WARNING/ERROR = Solo problemi
LOG_LEVEL=DEBUG3

# Abilita logging dettagliato per OGNI CAMPO validato
# true = Log per ogni attributo (verbose, utile per debug)
# false = Log solo a livello riga
DQ_ENABLE_FIELD_LOGGING=true

# Abilita logging dettagliato per OGNI RIGA elaborata
# true = Log per ogni record (verbose)
# false = Log solo statistiche finali
DQ_ENABLE_ROW_LOGGING=true

# ═══════════════════════════════════════════════════════════════════════════════
# SEZIONE 6: PATTERN MATCHING - Elaborazione File Multipli (opzionale)
# ═══════════════════════════════════════════════════════════════════════════════
# Abilita elaborazione di più file con wildcard (* ?)
# Se INPUT_FILE_NAME contiene wildcard, il framework:
# 1. Cerca tutti i file matching nel INPUT_DIR
# 2. Li ordina secondo SORT_KEYS (opzionale)
# 3. Seleziona file da processare con PROCESS_WHICH
# 4. Sposta file elaborati/skipped con suffissi timestamp

# Directory contenente i file da elaborare
# Esempio: C:\Python\demo\fixed\input\pending
# DQ_DIR_TO_SCAN=

# Pattern nome file con wildcard
# Esempi: *.txt, anagrafica_*.csv, dati_????0101.txt
# Se specificato, sovrascrive DQ_FILE_TO_CHECK
# INPUT_FILE_NAME=

# Chiavi ordinamento multi-livello (formato: nome[start:len:tipo:order])
# Esempio: nome[0:8:numero:desc],nome[9:6:stringa:asc]
# tipo: numero | stringa
# order: asc | desc
# SORT_KEYS=

# Chiavi ordinamento per data nel nome file (YYYYMMDD alla posizione 17)
SORT_KEYS=nome[17:8:numero:desc]

# Strategia selezione file (dopo ordinamento)
# first = Elabora solo il primo file
# last = Elabora solo l'ultimo file (default)
# all = Elabora tutti i file trovati
PROCESS_WHICH=last

# ═══════════════════════════════════════════════════════════════════════════════
# SEZIONE 7: OUTPUT NAMING - Suffix e Timestamp (opzionale, richiede pattern matching)
# ═══════════════════════════════════════════════════════════════════════════════
# Controlla naming dei file OUTPUT generati (OK/KO/reports)
# NOTA: Disponibile solo con pattern matching attivo (INPUT_FILE_NAME con wildcard)

# Aggiungere suffix e timestamp ai file OUTPUT generati?
# yes = File output: {basename_input}.{suffix}.{timestamp}.{ext}
# no = File output: nome fisso da configurazione (default)
# Esempio: se INPUT=test.txt, OUTPUT_VALID=test.validi.20251106143022.txt
OUTPUT_ADD_SUFFIX_TIMESTAMP=no

# Formato timestamp per file OUTPUT
# YYYYMMDDHHmmSS = 20251106143022 (default)
# YYYYMMDD_HHmmSS = 20251106_143022
# YYYYMMDD = 20251106
# YYYYMMDDHHmmSSfff = 20251106143022123
# OUTPUT_TIMESTAMP_FORMAT=YYYYMMDDHHmmSS

# Suffix per file record validi (default: validi)
# OUTPUT_SUFFIX_VALID=validi

# Suffix per file record errati (default: errori)
# OUTPUT_SUFFIX_ERROR=errori

# Suffix per file lista codici errore (default: codici)
# OUTPUT_SUFFIX_CODES=codici

# Suffix per file report statistiche (default: stats)
# OUTPUT_SUFFIX_STATS=stats

# ═══════════════════════════════════════════════════════════════════════════════
# SEZIONE 8: SPOSTAMENTO FILE INPUT - Gestione Post-Elaborazione (opzionale)
# ═══════════════════════════════════════════════════════════════════════════════
# Controlla naming e spostamento dei file INPUT dopo elaborazione
# NOTA: Disponibile solo con pattern matching attivo

# Aggiungere suffix e timestamp ai file INPUT spostati?
# yes = File spostati: {basename}.{suffix}.{timestamp} (default)
# no = File spostati: {basename}.{suffix}
# ADD_SUFFIX_TIMESTAMP=yes

# Formato timestamp per file INPUT spostati (vedi OUTPUT_TIMESTAMP_FORMAT per valori)
# TIMESTAMP_FORMAT=YYYYMMDDHHmmSS

# Spostare file NON elaborati (skipped) in directory separata?
# yes = Sposta in SKIPPED_DIR con suffix SUFFIX_SKIPPED
# no = Lascia file nel INPUT_DIR (default)
# MOVE_SKIPPED=no

# Directory destinazione file skipped
# SKIPPED_DIR=

# Spostare file ELABORATI (worked) in directory separata?
# yes = Sposta in WORKED_DIR con suffix (ok/ko/worked)
# no = Lascia file nel INPUT_DIR (default)
# MOVE_WORKED=no

# Directory destinazione file elaborati
# WORKED_DIR=

# Suffix per file elaborati con successo totale (100% validi)
# SUFFIX_VALID=ok

# Suffix per file elaborati con errori (0% validi)
# SUFFIX_ERROR=ko

# Suffix per file elaborati parzialmente (alcuni validi, alcuni errori)
# SUFFIX_WORKED=worked

# Suffix per file non elaborati (skipped)
# SUFFIX_SKIPPED=skipped

# ═══════════════════════════════════════════════════════════════════════════════
# FINE CONFIGURAZIONE
# ═══════════════════════════════════════════════════════════════════════════════
